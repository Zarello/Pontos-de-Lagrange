# -*- coding: utf-8 -*-
"""Cópia de Pontos_de_lagrange

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/17Racqqx1Q8E-OmfioamKjwD0uRxZE7ZE

Recursos utilizados
"""

import numpy as np
import matplotlib.pyplot as plt
import matplotlib.path as mpath
import math

"""Escolhemos quaisquer duas massas com ordem de grandeza significativa para o problema. Na realidade, como a origem do sistema se encontrará no centro de massa, conforme proposto por Lagrange, é possível que um dos corpos possua massa praticamente negligenciável em relação ao outro. Nesse caso, a origem do sistema estará no centro do corpo de maior massa, e os pontos poderão ser calculados normalmente. 

Algumas sugestões:

*   Massa do Sol: 1.989E30
*   Massa da Terra: 5.972E24
*   Massa da Lua: 7.35E22
*   Massa de Júpiter: 1.898E27



"""

# m1 representa a massa do corpo 1 e m2 a massa do corpo 2
m1 = float(input("Massa 1:"))
m2 = float(input("Massa 2:"))

"""A utilização das coordenadas adimensionais tem o intuito de obter soluções puramente numéricas para o problema em questão, que envolve grandezas físicas. Assim, é possível simplificar o problema e realizar diversas manipulações númericas com o problema sem precisar levar em conta as suas dimensões. A maneira mais simples de se criar uma grandeza adimensional é através da razão entre grandezas de mesma dimensão. 

O uso do recurso if/else abaixo ajusta a massa adimensional para manter a numeração correta dos pontos colineares de Lagrange.
"""

#m_adi representa a massa adimensional dos corpos

if m1 > m2:
  m_adi = m2/(m1 + m2)
else:
  m_adi = m1/(m1 + m2)
#if m_adi > 1:
  #while m_adi > 1:
    #m_adi = m_adi/10
#if m_adi <0.001:
  #while m_adi<0.001:
    #m_adi = m_adi*10

"""Agora definiremos os pontos a direita e a esquerda da origem do sistema, seguindo o mesmo eixo referência, para determinar os pontos colineares de Lagrange:"""

def coord(massa,n):
  x1 = (-massa) * np.cos(np.linspace(0, np.pi, n))
  x2 = (1-massa) * np.cos(np.linspace(0,np.pi,n))
  y1 = (-massa) * np.sin(np.linspace(0, np.pi, n))
  y2 = (1 - massa) * np.sin(np.linspace(0, np.pi, n))

  return x1,x2,y1,y2

x1,x2,y1,y2 = coord(m_adi, 500)

"""Finalmente, é possível definir uma função para encontrar os pontos colineares. Em seguida, o método de Newton-Raphson para encontrar 0 de funções será utilizado, então é preciso definir também um passo df para a função.

A fórmula utilizada para encontrar os pontos colineares na forma adimensional é a proposta por Rubinsztejn(2018):
![formula.png](data:image/png;base64,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)
"""

#Agora defimos a função para determinar os pontos lineares, utilizando a massa adimensional para facilitar a conta.

def f(x,m_adi):
  parte1 = x #valor inicial adimensional
  parte2 = ((1 - m_adi) * (x + m_adi)/ np.abs(x + m_adi))**3
  parte3 = (m_adi* (x - 1 + m_adi)) / np.abs(x - 1 + m_adi)**3
  eq =parte1-parte2-parte3
  return(eq)


def df(x):
    h = 0.0001
    return((f(x + h,m_adi) - f(x,m_adi))/h)

#Definição do método Newton Raphson:

xi = [0,1,-1]
tol = 0.000001
ni = 100
x = 0
pontos_lineares = []
for j in xi:
  x0 = j
  i = 1
  while i > ni or math.fabs(f(x0,m_adi))>tol:
    x = x0-f(x0,m_adi)/df(x0)
    x0 = x
    i += 1
    if i >= ni:
      print("Raiz não encontrada")
      break
  pontos_lineares.append(x0)

# Uma vez encontradas as posições em x dos pontos lineares, atribuimos os valores encontrados
# às suas devidas variaveis:

L1 = 0
L2 = 0
L3 = 0

def LinP(pontos_lineares):
  for i in range(0, len(pontos_lineares)):
    if i == 0:
      L1 = pontos_lineares[i]
    elif i==1:
      L2 = pontos_lineares[i]
    else:
      L3= pontos_lineares[i]
  return L1, L2, L3

L1,L2,L3 = LinP(pontos_lineares)

"""Para obter os pontos L4 e L5 foram utilizadas as coordenadas vetoriais demonstradas por Comish(1998):![formula2.png](data:image/png;base64,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)

Em que R é a distância entre os corpos e m1-m2/m1+m2 representa a massa adimensional. Essas coordenadas geram a posição dos 2 triângulos equiláteros que definem L4 e L5. Para fim de vizualização gráfica, definimos R = 1 de forma adimensional, ou seja, os pontos são gerados em torno de um círculo unitário.
"""

def trigP(massa, R=1):
  L4 = (R/2 * m_adi, R*(np.sqrt(3)/2))
  L5 = (R/2 * m_adi, R*(-np.sqrt(3)/2))

  return L4, L5
L4, L5 = trigP (m_adi)

#os 5 pontos de Lagrange
(L1,0),(L2,0),(L3,0),L4,L5

fig, ax = plt.subplots(figsize=(7,5), dpi=115)
ax.set_xlabel('Eixo dos pontos colineares')
ax.set_ylabel('y')
ax.axhline(0, color='k') #linha horizontal no eixo x 

# Plotando as orbitas e o losango que é formado pelas massas e ponto L4 e L5
####a função np.hstack gera uma lista unidimensional com as matrizes

ax.plot(np.hstack((x2, x2[::-1])), np.hstack((y2, -y2[::-1])))
ax.plot(np.hstack((x1, x1[::-1])), np.hstack((y1, -y1[::-1])))
ax.plot([-m_adi, 0.5 - m_adi, 1 - m_adi, 0.5 - m_adi, -m_adi], [0, np.sqrt(3)/2, 0, -np.sqrt(3)/2, 0], ls="-", lw=1)

# Plotando os pontos

ax.plot(L1, 0, 'X', label="$L_1$")
ax.plot(L2, 0, 'X', label="$L_2$")
ax.plot(L3, 0, 'X', label="$L_3$")
ax.plot(0.5 - m_adi, np.sqrt(3)/2, 'X', label="$L_4$")
ax.plot(0.5 - m_adi, -np.sqrt(3)/2, 'X', label="$L_5$")
ax.plot(-m_adi, 0, 'bo', label="$m_1$", ms=10) #massa maior
ax.plot(1 - m_adi, 0, 'go', label="$m_2$") #massa menor
ax.legend(loc='upper left')
plt.title('Pontos de Lagrange')
ax.set_aspect("equal")

"""REFERÊNCIAS 


    COMISH, Neil J. The Lagrange Points. 1998. Disponível em: <https://map.gsfc.nasa.gov/ContentMedia/lagrange.pdf >. Acesso em: 12 de out de 2022.

    ILLINOIS FACULTY OF MATH. Nondimensionalization, Scaling and Units. 2012. Disponível em: <https://faculty.math.illinois.edu/~rdeville/teaching/558/nondimensionalization.pdf>. Acesso em: 12 de out de 2022.

    KLIONER, Sergei. Celestial mechanics of the N-body problem. In: ALTENA, William F. V.. Astrometry for Astrophysics. Cambridge: Cambridge University Press, 2013. p.(69-92).

    ROY, Archie Edmiston. Orbital Motion. Bristol: IOP Publishing, 1988.

    RUBINSZTEJN, A. An Introduction to Lagrange Points - The 3-Body Problem. Gereshes. 2018. Disponível em: <https://gereshes.com/2018/12/03/an-introduction-to-lagrange-points-the-3-body-problem/>. Acesso em: 13 de out de 2022.

"""